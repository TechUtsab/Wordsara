<!DOCTYPE html>
<html lang="hi" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wordsara Creator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&family=Hind:wght@400;700&family=Mukta:wght@400;700&family=Poppins:wght@400;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *,:before,:after{box-sizing:border-box;margin:0;padding:0}
    body{background:linear-gradient(135deg,#1a1a1a,#121212);color:#fff;font-family:'Noto Sans Devanagari',sans-serif;padding-top:70px;min-height:100vh;display:flex;flex-direction:column}
    .app-bar{background:linear-gradient(to right,#10a37f,#0d8466);padding:.75rem 1.5rem;display:flex;justify-content:space-between;align-items:center;font-size:1.25rem;font-weight:700;color:#fff;position:fixed;top:0;left:0;right:0;z-index:1000;box-shadow:0 2px 5px rgba(0,0,0,.3)}
    .app-bar i{cursor:pointer;transition:transform .3s}
    .app-bar i:hover{transform:rotate(90deg)}
    .main-container{display:grid;grid-template-columns:1fr 1fr;gap:2rem;max-width:1200px;margin:2rem auto;padding:0 1rem}
    @media (max-width:768px){.main-container{grid-template-columns:1fr}}
    .form-section{background:#1e1e1e;padding:2rem;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.4)}
    .form-control,.form-select{background:#2a2a2a;color:#fff;border:1px solid #3a3a3a;border-radius:8px;padding:.75rem;transition:border-color .3s,box-shadow .3s}
    .form-control:focus,.form-select:focus{border-color:#10a37f;box-shadow:0 0 5px rgba(16,163,127,.5);background:#2a2a2a}
    .form-label{font-size:1rem;font-weight:600;margin-bottom:.5rem;color:#e0e0e0}
    .btn-custom{background:linear-gradient(to right,#10a37f,#0d8466);border:none;color:#fff;padding:.75rem 1.5rem;border-radius:8px;font-weight:600;transition:transform .2s,box-shadow .2s}
    .btn-custom:hover{transform:translateY(-2px);box-shadow:0 4px 10px rgba(16,163,127,.4)}
    .btn-custom:active{transform:translateY(0)}
    .preview-container{width:360px;background:#000;margin:0 auto;position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px 14px 20px;box-shadow:0 8px 20px rgba(0,0,0,.5);background-size:cover;background-position:center}
    .author-img-wrapper{height:80px;margin-bottom:10px;display:flex;justify-content:center;align-items:center;z-index:1}
    .preview-author-img{width:60px;height:60px;border-radius:50%;object-fit:cover;display:none}
    .preview-text{text-align:center;white-space:pre-wrap;width:70%;margin:0 15%;font-weight:500;display:flex;justify-content:center;align-items:center;min-height:20px;overflow-wrap:break-word;position:relative;z-index:1}
    .preview-author{font-size:calc(1em - 4px);opacity:.8;text-align:right;width:70%;margin:0 15% 0 auto;position:relative;z-index:1}
    .preview-logo{margin-top:10px;width:80px;height:80px;opacity:.9;filter:drop-shadow(0 2px 5px rgba(0,0,0,.5));z-index:1}
    .size-icon{font-size:1.5rem;cursor:pointer;margin-right:10px;color:#ccc;transition:color .3s,transform .3s}
    .size-icon:hover,.size-icon.active{color:#10a37f;transform:scale(1.2)}
    .form-check-input{background:#2a2a2a;border:1px solid #3a3a3a}
    .form-check-input:checked{background:#10a37f;border-color:#10a37f}
    .form-check-label{color:#e0e0e0}
    .dropdown-menu{background:#2a2a2a;border:1px solid #3a3a3a;border-radius:8px;padding:.5rem;min-width:220px}
    .dropdown-item{color:#e0e0e0;padding:.5rem 1rem;border-radius:4px;transition:background-color .2s}
    .dropdown-item:hover{background:#3a3a3a;color:#fff}
    .dropdown-form-group{padding:.5rem 1rem}
    #backgroundColorPicker{margin:.5rem auto;display:block}
    #hexColorInput,#backgroundImageUpload,#textColorHexInput{background:#2a2a2a;color:#e0e0e0;border:1px solid #3a3a3a;border-radius:8px;padding:.5rem;width:100%}
    #hexColorInput:focus,#backgroundImageUpload:focus,#textColorHexInput:focus{border-color:#10a37f;box-shadow:0 0 5px rgba(16,163,127,.5);outline:none}
    #hexColorInput,#textColorHexInput{text-transform:uppercase}
    .loading-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;justify-content:center;align-items:center;z-index:1001}
    .spinner{width:40px;height:40px;border:4px solid #10a37f;border-top:4px solid transparent;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    .warning-message{color:#fc0;font-size:.9rem;margin-top:.5rem;display:none}
    .modal-content{background:#2a2a2a;border:1px solid #3a3a3a;border-radius:8px}
    .modal-header,.modal-footer{border-color:#3a3a3a}
    .modal-title{color:#e0e0e0}
    .btn-close{filter:invert(1) grayscale(100%) brightness(200%)}
    @media (max-width:768px){.dropdown-menu{max-height:50vh;overflow-y:auto}.preview-container{width:100%;max-width:360px}}
  </style>
</head>
<body>
  <div class="app-bar">
    <span><i class="fa-solid fa-pen-nib me-2"></i>Wordsara Creator</span>
    <div class="dropdown">
      <i class="fa fa-cog" id="settingsIcon" data-bs-toggle="dropdown"></i>
      <div class="dropdown-menu" aria-labelledby="settingsIcon">
        <div class="dropdown-form-group">
          <label for="fontFamilySelect" class="form-label">Font Family</label>
          <select class="form-select" id="fontFamilySelect">
            <option value="'Noto Sans Devanagari', sans-serif" selected>Noto Sans Devanagari</option>
            <option value="'Hind', sans-serif">Hind</option>
            <option value="'Mukta', sans-serif">Mukta</option>
            <option value="'Poppins', sans-serif">Poppins</option>
          </select>
        </div>
        <div class="dropdown-form-group">
          <label for="backgroundColorPicker" class="form-label">Background Color</label>
          <div id="backgroundColorPicker"></div>
          <input type="text" id="hexColorInput" class="form-control mt-2" placeholder="#000000" maxlength="7">
          <label for="backgroundImageUpload" class="form-label mt-2">Background Image</label>
          <input type="file" id="backgroundImageUpload" class="form-control" accept="image/*">
        </div>
        <div class="dropdown-form-group">
          <label for="textColorSelect" class="form-label">Text Color</label>
          <select class="form-select" id="textColorSelect">
            <option value="#FFFFFF" selected>White</option>
            <option value="#000000">Black</option>
            <option value="#FF0000">Red</option>
            <option value="#0000FF">Blue</option>
            <option value="#00FF00">Green</option>
            <option value="#FFFF00">Yellow</option>
            <option value="#800080">Purple</option>
          </select>
          <label for="textColorHexInput" class="form-label mt-2">Custom Text Color</label>
          <input type="text" id="textColorHexInput" class="form-control mt-2" placeholder="#FFFFFF" maxlength="7">
        </div>
      </div>
    </div>
  </div>
  <div class="main-container">
    <div class="form-section">
      <div class="mb-4">
        <label for="textInput" class="form-label">Text (Highlight: [color=#FF0000]word[/color])</label>
        <textarea class="form-control" id="textInput" rows="4">लोग कहते है [color=#FF0000]कुछ[/color] अपने दिल की सुनाओ यहाँ दिल की खुद ही को समझ नहीं आ रही औरो को क्या सुनाए !!</textarea>
      </div>
      <div class="mb-4">
        <label for="authorInput" class="form-label">Author</label>
        <input type="text" class="form-control" id="authorInput">
      </div>
      <div class="mb-4">
        <label for="authorImageUpload" class="form-label">Author Photo</label>
        <input type="file" class="form-control" id="authorImageUpload" accept="image/*">
      </div>
      <div class="mb-4">
        <label for="fontSizeSelect" class="form-label">Font Size</label>
        <select class="form-select" id="fontSizeSelect">
          <option value="8">8px</option>
          <option value="10">10px</option>
          <option value="12">12px</option>
          <option value="14">14px</option>
          <option value="16" selected>16px</option>
          <option value="18">18px</option>
          <option value="20">20px</option>
          <option value="22">22px</option>
          <option value="25">25px</option>
          <option value="28">28px</option>
        </select>
      </div>
      <div class="mb-4 d-flex gap-3">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="boldToggle">
          <label class="form-check-label" for="boldToggle">Bold</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="italicToggle">
          <label class="form-check-label" for="italicToggle">Italic</label>
        </div>
      </div>
      <div class="mb-4">
        <label class="form-label">Frame Size</label>
        <div class="d-flex align-items-center">
          <i class="fa-solid fa-mobile-screen-button size-icon active" onclick="setFrameSize('reel',this)"></i>
          <i class="fa-regular fa-square size-icon" onclick="setFrameSize('square',this)"></i>
          <i class="fa-solid fa-tv size-icon" onclick="setFrameSize('landscape',this)"></i>
        </div>
      </div>
      <div class="mb-4 d-flex gap-2">
        <button class="btn btn-custom w-100" onclick="clearAll()">Clear</button>
        <button class="btn btn-custom w-100" data-bs-toggle="modal" data-bs-target="#scaleModal">Download</button>
      </div>
      <div id="warningMessage" class="warning-message">High scaling (3x/4x) may result in larger files.</div>
    </div>
    <div class="preview-container" id="preview">
      <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
      </div>
      <div class="author-img-wrapper">
        <img id="authorImgPreview" class="preview-author-img" alt="Author">
      </div>
      <div id="previewText" class="preview-text"></div>
      <div id="previewAuthor" class="preview-author"></div>
      <img src="wordsara_logoo.png" alt="Logo" class="preview-logo">
    </div>
  </div>
  <div class="modal fade" id="scaleModal" tabindex="-1" aria-labelledby="scaleModalLabel">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="scaleModalLabel">Choose Scale</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <label for="scaleSelectModal" class="form-label">Select Scale</label>
          <select class="form-select" id="scaleSelectModal">
            <option value="1">1x</option>
            <option value="2" selected>2x</option>
            <option value="3">3x</option>
            <option value="4">4x</option>
          </select>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-custom" onclick="download()">Download</button>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>
  <script>
    const colorPicker=new iro.ColorPicker("#backgroundColorPicker",{width:180,color:"#000000"}),
          els={textInput:document.getElementById("textInput"),authorInput:document.getElementById("authorInput"),fontSizeSelect:document.getElementById("fontSizeSelect"),boldToggle:document.getElementById("boldToggle"),italicToggle:document.getElementById("italicToggle"),fontFamilySelect:document.getElementById("fontFamilySelect"),textColorSelect:document.getElementById("textColorSelect"),textColorHexInput:document.getElementById("textColorHexInput"),hexColorInput:document.getElementById("hexColorInput"),backgroundImageUpload: matric.getElementById("backgroundImageUpload"),authorImageUpload:document.getElementById("authorImageUpload"),preview:document.getElementById("preview"),previewText:document.getElementById("previewText"),previewAuthor:document.getElementById("previewAuthor"),authorImgPreview:document.getElementById("authorImgPreview"),loadingOverlay:document.getElementById("loadingOverlay"),warningMessage:document.getElementById("warningMessage")};
    let bgImage=null,frameWidth=360,frameHeight=640;
    const updatePreview=()=>{const{textInput,authorInput,fontSizeSelect,boldToggle,italicToggle,fontFamilySelect,textColorSelect,textColorHexInput,preview,previewText,previewAuthor,authorImgPreview,authorImageUpload}=els,{value:text="Default Text"}=textInput,{value:author=""}=authorInput,fs=+fontSizeSelect.value,bold=boldToggle.checked,italic=italicToggle.checked,ff=fontFamilySelect.value,bg=bgImage?`url(${bgImage})`:colorPicker.color.hexString,tc=/^#?[0-9A-Fa-f]{6}$/.test(textColorHexInput.value)?textColorHexInput.value.match(/^#/)?.[0]?textColorHexInput.value:`#${textColorHexInput.value}`:textColorSelect.value;preview.style.cssText=`background:${bg};background-size:${bgImage?"cover":""};background-position:${bgImage?"center":""};width:${frameWidth}px;height:${frameHeight}px`;els.hexColorInput.value=colorPicker.color.hexString.toUpperCase();previewText.innerHTML=text.replace(/\[color=(#[0-9A-Fa-f]{6})\](.*?)\[\/color\]/g,'<span style="color:$1">$2</span>').replace(/^/,'<span style="color:'+tc+'">').replace(/$/,'</span>');Object.assign(previewText.style,{fontSize:fs+"px",fontWeight:bold?"bold":"normal",fontStyle:italic?"italic":"normal",fontFamily:ff,color:tc,marginTop:"10px"});previewAuthor.textContent=author?`~ ${author}`:"";Object.assign(previewAuthor.style,{fontSize:(fs-4)+"px",fontFamily:ff,color:tc,marginTop:"10px"});if(authorImageUpload.files[0]){const r=new FileReader();r.onload=()=>{authorImgPreview.src=r.result;authorImgPreview.style.display="block"};r.readAsDataURL(authorImageUpload.files[0])}else{authorImgPreview.src="";authorImgPreview.style.display="none"};preview.offsetHeight};
    const clearAll=()=>{Object.assign(els,{textInput:{value:""},authorInput:{value:""},authorImageUpload:{value:""},backgroundImageUpload:{value:""},fontSizeSelect:{value:"16"},boldToggle:{checked:false},italicToggle:{checked:false},fontFamilySelect:{value:"'Noto Sans Devanagari', sans-serif"},textColorSelect:{value:"#FFFFFF"},textColorHexInput:{value:"#FFFFFF"}});bgImage=null;colorPicker.color.hexString="#000000";els.hexColorInput.value="#000000";setFrameSize("reel",document.querySelector(".size-icon.fa-mobile-screen-button"));updatePreview()};
    colorPicker.on("color:change",c=>!bgImage&&(els.preview.style.background=c.hexString,els.hexColorInput.value=c.hexString.toUpperCase()));
    els.hexColorInput.addEventListener("input",({target:{value:h}})=>/^#?[0-9A-Fa-f]{6}$/.test(h)&&(h=h.match(/^#/)?.[0]?h:`#${h}`,colorPicker.color.hexString=h,!bgImage&&(els.preview.style.background=h)));
    els.backgroundImageUpload.addEventListener("change",({target:{files}})=>{if(files[0]){const r=new FileReader();r.onload=()=>{bgImage=r.result;els.preview.style.cssText=`background:url(${bgImage});background-size:cover;background-position:center;width:${frameWidth}px;height:${frameHeight}px`;updatePreview()};r.readAsDataURL(files[0])}else{bgImage=null;updatePreview()}});
    ["textInput","authorInput","fontSizeSelect","boldToggle","italicToggle","authorImageUpload","fontFamilySelect","textColorSelect"].forEach(id=>els[id].addEventListener(id.includes("Input")?"input":"change",updatePreview));
    els.textColorHexInput.addEventListener("input",({target:{value}})=>/^#?[0-9A-Fa-f]{6}$/.test(value)&&updatePreview());
    const setFrameSize=(size,icon)=>{document.querySelectorAll(".size-icon").forEach(i=>i.classList.remove("active"));icon.classList.add("active");const s=size==="reel"?{ar:"9/16",w:360,h:640}:size==="square"?{ar:"1/1",w:360,h:360}:{ar:"16/9",w:640,h:360};frameWidth=s.w;frameHeight=s.h;Object.assign(els.preview.style,{aspectRatio:s.ar,width:`${s.w}px`,height:`${s.h}px`,maxWidth:`${s.w}px`});updatePreview()};
    const download=()=>{const{preview,loadingOverlay,warningMessage}=els,scale=+document.getElementById("scaleSelectModal").value,modal=bootstrap.Modal.getInstance(document.getElementById("scaleModal"));loadingOverlay.style.display="flex";modal.hide();if(scale>2){warningMessage.style.display="block";setTimeout(()=>(warningMessage.style.display="none"),3e3)}loadingOverlay.style.display="none";html2canvas(preview,{scale,useCORS:true,backgroundColor:null}).then(c=>{const t=document.createElement("canvas"),w=frameWidth*scale,h=frameHeight*scale;t.width=w;t.height=h;t.getContext("2d").drawImage(c,0,0,w,h);const l=document.createElement("a");l.download=`reel-text-${scale}x.png`;l.href=t.toDataURL("image/png");l.click();loadingOverlay.style.display="none"}).catch(e=>{console.error(`Error at ${scale}x:`,e);alert("Download failed.");loadingOverlay.style.display="none"})};
    updatePreview();
  </script>
</body>
</html>
